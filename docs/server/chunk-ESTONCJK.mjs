import './polyfills.server.mjs';
import{a as R}from"./chunk-QWTEOBRJ.mjs";import{a as y}from"./chunk-3JTQHYFI.mjs";import{a as O,b as p,c as L,d as E,e as w,f as h,h as N,i as x,j as k,m as F}from"./chunk-WJEQEY6J.mjs";import"./chunk-WVUI6REW.mjs";import{a as _,d as C}from"./chunk-WI2M6OGW.mjs";import"./chunk-GENOAINO.mjs";import"./chunk-5YC5RUDY.mjs";import{Hb as s,Pb as v,Qa as a,Y as d,aa as g,fb as f,hb as c,lb as b,pb as n,qb as e,rb as l,yb as u}from"./chunk-R445CJHI.mjs";import"./chunk-VVCT4QZE.mjs";function T(o,r){o&1&&(n(0,"span"),l(1,"i",13),e())}function A(o,r){o&1&&(n(0,"span"),l(1,"i",13),e())}var j=(()=>{let r=class r{constructor(){this._ActivatedRoute=d(_),this._OrdersService=d(R),this._Router=d(C),this._CartService=d(y),this.isLoadingCash=!1,this.isLoading=!1,this.orders=new w({details:new h(null,p.required),phone:new h(null,p.required),city:new h(null,p.required)}),this.cartId=""}ngOnInit(){this._ActivatedRoute.paramMap.subscribe({next:t=>{this.cartId=t.get("id")}})}orderSubmit(){this.isLoading=!0,this.orderSubmitUnSub=this._OrdersService.checkOut(this.cartId,this.orders.value).subscribe({next:t=>{this.isLoading=!1,t.status==="success"&&window.open(t.session.url)},error:t=>{console.log(t),this.isLoading=!1}})}ngOnDestroy(){this.orderSubmitUnSub?.unsubscribe(),this.cashPayUnSub?.unsubscribe()}cashPay(){this.isLoadingCash=!0,this.cashPayUnSub=this._OrdersService.cashOrders(this.cartId,this.orders.value).subscribe({next:t=>{this.isLoadingCash=!1,this._Router.navigate(["/allorders"]),this._CartService.cartNumber.set(0)},error:t=>{this.isLoadingCash=!1,console.log(t)}})}};r.\u0275fac=function(m){return new(m||r)},r.\u0275cmp=g({type:r,selectors:[["app-orders"]],standalone:!0,features:[v],decls:23,vars:5,consts:[[1,"bg-main-light","rounded-4","shadow","p-2","my-2","w-75","mx-auto"],[1,"text-center"],[3,"ngSubmit","formGroup"],[1,"my-1"],["for","details"],["formControlName","details","id","details",1,"form-control"],["for","phone"],["formControlName","phone","id","phone","type","tel",1,"form-control"],["for","city"],["formControlName","city","id","city","type","text",1,"form-control"],[1,"d-flex","justify-content-center","gap-3"],["type","submit",1,"btn-main",3,"click","disabled"],["type","button",1,"btn-main",3,"click","disabled"],[1,"fas","fa-spin","fa-spinner"]],template:function(m,i){m&1&&(n(0,"section",0)(1,"h1",1),s(2," shippingAddress"),e(),n(3,"form",2),u("ngSubmit",function(){return i.orderSubmit()}),n(4,"div",3)(5,"label",4),s(6,"details"),e(),l(7,"textarea",5),e(),n(8,"div",3)(9,"label",6),s(10,"phone"),e(),l(11,"input",7),e(),n(12,"div",3)(13,"label",8),s(14,"city"),e(),l(15,"input",9),e(),n(16,"div",10)(17,"button",11),u("click",function(){return i.orderSubmit()}),s(18,"Credit cart "),f(19,T,2,0,"span"),e(),n(20,"button",12),u("click",function(){return i.cashPay()}),s(21,"cash Payment "),f(22,A,2,0,"span"),e()()()()),m&2&&(a(3),c("formGroup",i.orders),a(14),c("disabled",i.orders.invalid||i.isLoading),a(2),b(19,i.isLoading?19:-1),a(),c("disabled",i.orders.invalid||i.isLoadingCash),a(2),b(22,i.isLoading?22:-1))},dependencies:[F,N,O,L,E,x,k]});let o=r;return o})();export{j as OrdersComponent};
